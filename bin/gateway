#!/usr/bin/env node

var program = require('commander');
var gateway = require('../lib/gateway');
var PrettyPrintTable = require('../lib/pretty_print_tables.js');

var cli = require('../cli/index.js');

program
  .version('0.0.1')
  .option('-i, --issuer', 'specify an issuer other than the cold wallet')
  .option('-e, --env', 'specify the environment');

program
  .command('list_incoming_payments')
  .description('list incoming ripple payments in the queue to be processed')
  .action(cli.listIncomingPayments);

program
  .command('list_withdrawals')
  .description('get pending withdrawals to external accounts')
  .action(cli.listWithdrawals);

program
  .command('clear_withdrawal <external_transaction_id>')
  .description('clear pending withdrawal to external account')
  .action(cli.clearWithdrawal);

program
  .command('fund_hot_wallet <amount> <currency> <secret>')
  .description('issue funds from cold wallet to hot wallet') 
  .action(cli.fundHotWallet);

program
  .command('record_deposit <amount> <currency> <external_account_id>')
  .description('record a deposit in the deposit processing queue')
  .action(cli.recordDeposit);

program
  .command('list_deposits')
  .description('list deposits in the deposit processing queue')
  .action(function() {
    gateway.deposits.listQueued(function(err, deposits) {
      PrettyPrintTable.externalTransactions(deposits);
    });
  });

program
  .command('list_outgoing_payments')
  .description('list the outgoing ripple payments.')
  .action(function(){
    gateway.payments.listOutgoing(function(err, transactions) {
      PrettyPrintTable.payments(transactions);
    });
  });

program
  .command('list_users')
  .description('list registered users')
  .action(cli.listUsers);

program
  .command('register_user <username> <password> <ripple_address>')
  .description('create a user with a ripple address')
  .action(cli.registerUser);

program.parse(process.argv);

